<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>C Chord Badge</title>
<style>
body{
  margin:0;
  background:#0f1115;
  color:#e6e9ef;
  font-family:system-ui,-apple-system,sans-serif;
}
.wrap{
  max-width:1000px;
  margin:40px auto;
  padding:26px;
  background:linear-gradient(180deg,#1b1f27,#141821);
  border-radius:18px;
}
h1{margin:0;font-size:28px}
.sub{opacity:.6;font-size:13px;margin-bottom:18px}
.main{display:grid;grid-template-columns:1fr 300px;gap:20px}

/* ---------- FRETBOARD ---------- */
svg{
  width:100%;
  height:360px;
  background:radial-gradient(120% 120% at 50% 0%,#242a35,#151a22);
  border-radius:14px;
}
.string{stroke:rgba(255,255,255,.28);stroke-width:2}
.fret{stroke:rgba(255,255,255,.15);stroke-width:2}
.dot{fill:#7ef0c4;stroke:#0c1b14;stroke-width:2}
.dotText{fill:#0c1b14;font-weight:900;font-size:14px;text-anchor:middle;dominant-baseline:middle}
.labelText{fill:rgba(255,255,255,.65);font-size:12px}

/* ---------- PANEL ---------- */
.panel{
  background:rgba(255,255,255,.04);
  border-radius:14px;
  padding:16px;
}
.codeName{font-size:30px;font-weight:900}
.tones{font-size:13px;opacity:.75;margin-bottom:14px}
.section{margin-bottom:14px}
.label{font-size:12px;opacity:.6;margin-bottom:6px}
.btns{display:flex;flex-wrap:wrap;gap:6px}
button{
  background:#222834;
  color:#e6e9ef;
  border:none;
  border-radius:999px;
  padding:7px 12px;
  font-size:13px;
  cursor:pointer;
}
button.active{
  background:#7ef0c4;
  color:#0c1b14;
  font-weight:800;
}
</style>
</head>

<body>
<div class="wrap">
  <h1>C</h1>
  <div class="sub">Triad + 7th + Extensions 구조</div>

  <div class="main">
    <svg id="fretboard" viewBox="0 0 720 360"></svg>

    <div class="panel">
      <div class="codeName" id="codeName">C</div>
      <div class="tones" id="tones"></div>

      <div class="section">
        <div class="label">Triad</div>
        <div class="btns">
          <button id="majBtn" class="active">Major</button>
          <button id="minBtn">Minor</button>
        </div>
      </div>

      <div class="section">
        <div class="label">7th</div>
        <div class="btns">
          <button data-7="none" class="active">없음</button>
          <button data-7="b7">♭7</button>
          <button data-7="M7">M7</button>
        </div>
      </div>

      <div class="section">
        <div class="label">Extensions</div>
        <div class="btns">
          <button id="add9Btn">add9</button>
          <button data-ext="9">9</button>
          <button data-ext="11">11</button>
          <button data-ext="13">13</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* ---------- STATE ---------- */
const state={
  triad:"maj",
  seventh:"none",
  add9:false,
  ext:null // null | 9 | 11 | 13
};

/* ---------- AUTO 7 RULE ---------- */
function applyAuto7(){
  if(state.ext!==null){
    state.seventh="b7";
    document.querySelectorAll("[data-7]").forEach(b=>{
      b.classList.toggle("active",b.dataset["7"]==="b7");
    });
  }
}

/* ---------- CHORD NAME ---------- */
function chordName(){
  let n="C";
  if(state.triad==="min") n+="m";

  if(state.ext!==null){
    n+=state.ext;
  }else{
    if(state.seventh==="b7") n+="7";
    if(state.seventh==="M7") n+="M7";
  }

  if(state.add9 && state.ext===null) n+="add9";
  return n;
}

/* ---------- CHORD TONES ---------- */
function chordTones(){
  const t=[];
  t.push("C");
  t.push(state.triad==="min"?"Eb":"E");
  t.push("G");

  if(state.seventh==="b7") t.push("Bb");
  if(state.seventh==="M7") t.push("B");

  if(state.add9 || state.ext!==null) t.push("D");
  if(state.ext>=11) t.push("F");
  if(state.ext===13) t.push("A");

  return t;
}

/* ---------- FRETBOARD ---------- */
function drawFretboard(){
  const svg=document.getElementById("fretboard");
  svg.innerHTML="";
  const W=720,H=360,p=50;
  const strings=6,frets=9;
  const gx=(W-p*2)/frets;
  const gy=(H-p*2)/(strings-1);

  // string labels (1~6)
  const labels=["1(e)","2(B)","3(G)","4(D)","5(A)","6(E)"];
  labels.forEach((l,i)=>{
    const y=p+i*gy+4;
    svg.innerHTML+=`<text x="20" y="${y}" class="labelText">${l}</text>`;
  });

  // strings
  for(let s=0;s<strings;s++){
    const y=p+s*gy;
    svg.innerHTML+=`<line x1="${p}" x2="${W-p}" y1="${y}" y2="${y}" class="string"/>`;
  }

  // frets
  for(let f=0;f<=frets;f++){
    const x=p+f*gx;
    svg.innerHTML+=`<line x1="${x}" x2="${x}" y1="${p}" y2="${H-p}" class="fret"/>`;
  }

  // example voicing (C7 open)
  const dots=[
    {s:1,f:1,n:1},
    {s:3,f:3,n:4},
    {s:4,f:2,n:2},
    {s:5,f:3,n:3}
  ];

  dots.forEach(d=>{
    const cx=p+(d.f-0.5)*gx;
    const cy=p+(d.s-1)*gy;
    svg.innerHTML+=`
      <circle cx="${cx}" cy="${cy}" r="14" class="dot"/>
      <text x="${cx}" y="${cy+1}" class="dotText">${d.n}</text>`;
  });
}

/* ---------- RENDER ---------- */
function render(){
  applyAuto7();
  document.getElementById("codeName").innerText=chordName();
  document.getElementById("tones").innerText=
    "Chord tones: "+chordTones().join(" – ");
  drawFretboard();
}

/* ---------- EVENTS ---------- */
majBtn.onclick=()=>{
  state.triad="maj";
  majBtn.classList.add("active");
  minBtn.classList.remove("active");
  render();
};
minBtn.onclick=()=>{
  state.triad="min";
  minBtn.classList.add("active");
  majBtn.classList.remove("active");
  render();
};

document.querySelectorAll("[data-7]").forEach(b=>{
  b.onclick=()=>{
    state.seventh=b.dataset["7"];
    document.querySelectorAll("[data-7]").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    render();
  };
});

add9Btn.onclick=()=>{
  state.add9=!state.add9;
  add9Btn.classList.toggle("active",state.add9);
  render();
};

document.querySelectorAll("[data-ext]").forEach(b=>{
  b.onclick=()=>{
    state.ext=b.dataset.ext;
    document.querySelectorAll("[data-ext]").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    render();
  };
});

render();
</script>
</body>
</html>
