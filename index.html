<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>C Chord Badge</title>
<style>
  body {
    margin: 0;
    font-family: system-ui, -apple-system, sans-serif;
    background: #0f1115;
    color: #e6e9ef;
  }

  .wrap {
    max-width: 980px;
    margin: 40px auto;
    padding: 24px;
    background: linear-gradient(180deg,#1b1f27,#141821);
    border-radius: 18px;
    box-shadow: 0 30px 80px rgba(0,0,0,.45);
  }

  h1 {
    margin: 0 0 6px;
    font-size: 28px;
  }

  .sub {
    opacity: .65;
    font-size: 13px;
    margin-bottom: 18px;
  }

  .main {
    display: grid;
    grid-template-columns: 1fr 280px;
    gap: 20px;
  }

  /* ---------- FRETBOARD ---------- */

  svg {
    width: 100%;
    height: 360px;
    background: radial-gradient(120% 120% at 50% 0%, #242a35, #151a22);
    border-radius: 14px;
  }

  .string {
    stroke: rgba(255,255,255,.25);
    stroke-width: 2;
  }

  .fret {
    stroke: rgba(255,255,255,.15);
    stroke-width: 2;
  }

  .dot {
    fill: #7ef0c4;
    stroke: rgba(0,0,0,.4);
    stroke-width: 2;
  }

  .dotText {
    fill: #0c1b14;
    font-size: 14px;
    font-weight: 900;
    text-anchor: middle;
    dominant-baseline: middle;
  }

  .open {
    fill: none;
    stroke: #7ef0c4;
    stroke-width: 3;
  }

  .mute {
    fill: #f0c46a;
    font-weight: 900;
  }

  /* ---------- CONTROLS ---------- */

  .panel {
    background: rgba(255,255,255,.04);
    border-radius: 14px;
    padding: 16px;
  }

  .codeName {
    font-size: 28px;
    font-weight: 900;
    margin-bottom: 6px;
  }

  .tones {
    font-size: 13px;
    opacity: .75;
    margin-bottom: 14px;
  }

  .section {
    margin-bottom: 14px;
  }

  .label {
    font-size: 12px;
    opacity: .6;
    margin-bottom: 6px;
  }

  .btns {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  }

  button {
    background: #222834;
    color: #e6e9ef;
    border: none;
    border-radius: 999px;
    padding: 7px 12px;
    font-size: 13px;
    cursor: pointer;
  }

  button.active {
    background: #7ef0c4;
    color: #0c1b14;
    font-weight: 800;
  }
</style>
</head>

<body>
<div class="wrap">
  <h1 id="title">C</h1>
  <div class="sub">Triad + 7th + Extensions 구조</div>

  <div class="main">
    <svg id="fretboard" viewBox="0 0 720 360"></svg>

    <div class="panel">
      <div class="codeName" id="codeName">C</div>
      <div class="tones" id="tones"></div>

      <div class="section">
        <div class="label">Triad</div>
        <div class="btns">
          <button id="majBtn" class="active">Major</button>
          <button id="minBtn">Minor</button>
        </div>
      </div>

      <div class="section">
        <div class="label">7th</div>
        <div class="btns">
          <button data-7="none" class="active">없음</button>
          <button data-7="b7">♭7</button>
          <button data-7="M7">M7</button>
        </div>
      </div>

      <div class="section">
        <div class="label">Extensions</div>
        <div class="btns">
          <button data-ext="add9">add9</button>
          <button data-ext="9">9</button>
          <button data-ext="11">11</button>
          <button data-ext="13">13</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* ---------- STATE ---------- */
const state = {
  triad: "maj",      // maj | min
  seventh: "none",   // none | b7 | M7
  exts: new Set()
};

/* ---------- NOTES ---------- */
const NOTES = ["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"];

/* ---------- AUTO 7 RULE ---------- */
function applyAuto7(){
  if (state.exts.has("9") || state.exts.has("11") || state.exts.has("13")) {
    state.seventh = "b7";
    document.querySelectorAll("[data-7]").forEach(b=>{
      b.classList.toggle("active", b.dataset["7"]==="b7");
    });
  }
}

/* ---------- CHORD NAME ---------- */
function chordName(){
  let n = "C";
  if (state.triad === "min") n += "m";
  if (state.seventh === "b7") n += "7";
  if (state.seventh === "M7") n += "M7";

  state.exts.forEach(e=>{
    if (e==="add9") n += "add9";
    else n += e;
  });
  return n;
}

/* ---------- CHORD TONES ---------- */
function chordTones(){
  const t = [];
  t.push("C");
  t.push(state.triad==="min" ? "Eb" : "E");
  t.push("G");

  if (state.seventh==="b7") t.push("Bb");
  if (state.seventh==="M7") t.push("B");

  if (state.exts.has("add9") || state.exts.has("9") || state.exts.has("11") || state.exts.has("13"))
    t.push("D");
  if (state.exts.has("11") || state.exts.has("13"))
    t.push("F");
  if (state.exts.has("13"))
    t.push("A");

  return t;
}

/* ---------- FRETBOARD (대표 보이싱 예시) ---------- */
function drawFretboard(){
  const svg = document.getElementById("fretboard");
  svg.innerHTML = "";

  const W=720,H=360,pad=50;
  const strings=6, frets=9;
  const gapX=(W-pad*2)/frets;
  const gapY=(H-pad*2)/(strings-1);

  // strings
  for(let s=0;s<strings;s++){
    const y=pad+s*gapY;
    svg.innerHTML+=`<line x1="${pad}" x2="${W-pad}" y1="${y}" y2="${y}" class="string"/>`;
  }

  // frets
  for(let f=0;f<=frets;f++){
    const x=pad+f*gapX;
    svg.innerHTML+=`<line x1="${x}" x2="${x}" y1="${pad}" y2="${H-pad}" class="fret"/>`;
  }

  // example dots (C7 open shape)
  const dots = [
    {s:2,f:1,n:1},
    {s:4,f:2,n:2},
    {s:5,f:3,n:3},
    {s:3,f:3,n:4}
  ];

  dots.forEach(d=>{
    const cx=pad+(d.f-0.5)*gapX;
    const cy=pad+(d.s-1)*gapY;
    svg.innerHTML+=`
      <circle cx="${cx}" cy="${cy}" r="14" class="dot"/>
      <text x="${cx}" y="${cy+1}" class="dotText">${d.n}</text>
    `;
  });
}

/* ---------- RENDER ---------- */
function render(){
  applyAuto7();
  document.getElementById("codeName").innerText = chordName();
  document.getElementById("tones").innerText =
    "Chord tones: " + chordTones().join(" – ");
  drawFretboard();
}

/* ---------- EVENTS ---------- */
document.getElementById("majBtn").onclick=()=>{
  state.triad="maj";
  majBtn.classList.add("active");
  minBtn.classList.remove("active");
  render();
};
document.getElementById("minBtn").onclick=()=>{
  state.triad="min";
  minBtn.classList.add("active");
  majBtn.classList.remove("active");
  render();
};

document.querySelectorAll("[data-7]").forEach(b=>{
  b.onclick=()=>{
    state.seventh=b.dataset["7"];
    document.querySelectorAll("[data-7]").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    render();
  };
});

document.querySelectorAll("[data-ext]").forEach(b=>{
  b.onclick=()=>{
    const e=b.dataset.ext;
    if(state.exts.has(e)){
      state.exts.delete(e);
      b.classList.remove("active");
    }else{
      state.exts.add(e);
      b.classList.add("active");
    }
    render();
  };
});

render();
</script>
</body>
</html>
